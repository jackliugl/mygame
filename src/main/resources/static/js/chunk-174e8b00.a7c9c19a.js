(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-174e8b00"],{"254f":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list row"},[n("div",{staticClass:"col-md-12"},[n("center",[n("b-carousel",{staticClass:"ml-1"},[n("b-carousel-slide",{attrs:{"caption-html":"<h3>Welcome to Jack's Store</h3>","text-html":"Please use self-checkout. <b><i>Only gift card is accepted.</i></b>","img-src":"summer1.png"}})],1),n("b-row",{staticClass:"mb-1 mt-1"},[n("b-col",{attrs:{cols:"12"}},[n("b-button",{staticClass:"badge-default ml-1 mr-1",attrs:{block:"",id:"scan",size:"lg",variant:"outline-primary",disabled:t.started},on:{click:function(e){return e.preventDefault(),t.startScan.apply(null,arguments)}}},[n("b-icon",{attrs:{icon:"upc-scan"}}),t._v(" Start Scanning Barcode")],1)],1)],1),n("div",[n("b-table",{staticClass:"ml-1",attrs:{small:"",fields:t.fields,items:t.itemList,responsive:"sm"},scopedSlots:t._u([{key:"cell(index)",fn:function(e){return[e.item.fake?t._e():n("div",[t._v(t._s(e.index+1))])]}},{key:"cell(barcode)",fn:function(e){return[e.item.fake?"Tax"==e.value?n("div",[n("b",[t._v(t._s(e.value)+"("+t._s(100*e.item.price)+"%)")])]):n("div",[n("b",[t._v(t._s(e.value))])]):n("div",[n("b-img",{attrs:{src:"barcode/"+e.value.toLowerCase().replace(/\s/g,"")+".png",rounded:"circle",width:"24",height:"24"}}),n("b",{staticClass:"text-info"},[t._v(t._s(e.value.toUpperCase()))])],1)]}},{key:"cell(quantity)",fn:function(e){return[e.item.fake?t._e():n("div",[n("b-form-spinbutton",{attrs:{id:"sb-inline",value:e.value,min:"0",max:"50",size:"sm",inline:"",disabled:t.paymentStarted},on:{change:function(n){return t.updateItem(e.item,n)}}}),n("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}},{name:"show",rawName:"v-show",value:!t.paymentStarted,expression:"!paymentStarted"}],staticClass:"ml-2",attrs:{icon:"trash",variant:"danger",title:"Remove "+e.item.barcode},on:{click:function(n){return n.preventDefault(),t.deleteItem(e.item)}}})],1)]}},{key:"cell(price)",fn:function(e){return[e.item.fake?t._e():n("div",[t._v("$"+t._s(e.value))])]}},{key:"cell(amount)",fn:function(e){return[e.item.fake?n("div",[n("b",[n("i",[t._v("$"+t._s(e.value))])])]):n("div",[n("i",[t._v("$"+t._s(e.value))])])]}},{key:"cell()",fn:function(e){return[n("i",[t._v(t._s(e.value))])]}}])})],1)],1)],1),n("div",{staticClass:"col-md-12"},[n("b-row",{staticClass:"mt-2"},[n("b-col",{attrs:{cols:"6"}},[n("b-button",{staticClass:"badge-default ml-1 mr-1",attrs:{block:"",id:"pay",size:"lg",variant:"outline-primary",disabled:0==t.itemList.length||t.paymentStarted||0==t.itemList[t.itemList.length-1].amount},on:{click:function(e){return e.preventDefault(),t.proceedToPay.apply(null,arguments)}}},[t._v("Finish and Pay")])],1),n("b-col",{attrs:{cols:"6"}},[n("b-button",{directives:[{name:"show",rawName:"v-show",value:t.paymentStarted,expression:"paymentStarted"}],staticClass:"badge-default ml-1 mr-1",attrs:{block:"",id:"cancel",variant:"outline-primary",size:"lg",disabled:0==t.paymentStarted||t.transactionCompleted},on:{click:function(e){return e.preventDefault(),t.cancelPayment.apply(null,arguments)}}},[t._v(" Cancel Payment ")])],1)],1),n("b-row",[n("b-col",{attrs:{cols:"12"}},[n("b-alert",{staticClass:"ml-1 mt-1",attrs:{show:t.paymentStarted&&t.showPaymentAlert&&!t.isValidCard()}},[n("b",[t._v("PLEASE SCAN YOUR GIFT CARD ...")])])],1)],1),n("b-row",{staticClass:"mt-2",attrs:{"align-v":"center"}},[n("b-col",{attrs:{cols:"9"}},[n("b-alert",{staticClass:"ml-1 mb-0 w-100",attrs:{show:t.paymentStarted&&t.isValidCard()&&!t.transactionCompleted,variant:"success"}},[n("b-img",{attrs:{src:t.getCardImg(),rounded:"circle",width:"32",height:"32"}}),n("b-icon",{attrs:{icon:"credit-card"}}),n("b-img",{directives:[{name:"show",rawName:"v-show",value:t.paymentInfo.pinProtected,expression:"paymentInfo.pinProtected"},{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{src:"password-protected.png",rounded:"circle",width:"16",height:"16",title:"PIN Protected"}}),n("b",[t._v(" Card No: "+t._s(t.paymentInfo.cardNo)+", Balance: $"+t._s(t.paymentInfo.cardBalance)+", Total Cost: $"+t._s(t.paymentInfo.totalCost)+" ")]),t.paymentInfo.cardBalance<t.paymentInfo.totalCost?n("div",[n("font",{attrs:{color:"red"}},[t._v("Insufficient balance!")])],1):t._e()],1),n("b-alert",{staticClass:"ml-1 mb-0 w-100",attrs:{show:t.transactionCompleted&&t.isValidCard(),variant:"info"}},[n("b",[t._v("Transaction Completed! "),n("br"),n("b-img",{attrs:{src:t.getCardImg(),rounded:"circle",width:"32",height:"32"}}),n("b-icon",{attrs:{icon:"credit-card"}}),n("b-img",{directives:[{name:"show",rawName:"v-show",value:t.paymentInfo.pinProtected,expression:"paymentInfo.pinProtected"},{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{src:"password-protected.png",rounded:"circle",width:"16",height:"16",title:"PIN Protected"}}),t._v(" Card No: "+t._s(t.paymentInfo.cardNo)+", Remaining Balance: $"+t._s(t.paymentInfo.newBalance)+" ")],1)])],1),n("b-col",{attrs:{cols:"3"}},[n("b-button",{directives:[{name:"show",rawName:"v-show",value:t.paymentStarted&&t.isValidCard(),expression:"paymentStarted && isValidCard()"}],staticClass:"badge-default ml-1 mr-1",attrs:{block:"",id:"confirmPayment",variant:"outline-primary",size:"lg",disabled:0==t.paymentStarted||t.paymentInfo.cardBalance<t.paymentInfo.totalCost||t.transactionCompleted},on:{click:function(e){return e.preventDefault(),t.preConfirmPayment.apply(null,arguments)}}},[t._v(" Confirm Payment ")])],1)],1),n("b-row",{staticClass:"mt-2"},[n("b-col",{attrs:{cols:"12"}},[n("b-button",{directives:[{name:"show",rawName:"v-show",value:t.transactionCompleted,expression:"transactionCompleted"}],staticClass:"badge-default ml-1 mr-1",attrs:{block:"",id:"startOver",variant:"outline-primary",size:"lg",disabled:1==t.paymentStarted&&!t.transactionCompleted},on:{click:function(e){return e.preventDefault(),t.startOver.apply(null,arguments)}}},[t._v(" Thanks for Shopping at Jack's Store! "),n("b",[t._v("Click Here to Start Over")])])],1)],1)],1),n("b-modal",{ref:"my-modal-pin",attrs:{title:"PIN Code for "+t.paymentInfo.cardNo,size:"sm",centered:"","hide-footer":"","no-close-on-esc":"","no-close-on-backdrop":"","hide-header-close":""}},[n("b-form-input",{attrs:{placeholder:"Enter your PIN",type:"password"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.verifyPin()}},model:{value:t.pinCode,callback:function(e){t.pinCode=e},expression:"pinCode"}}),n("b-row",{staticClass:"mt-2"},[n("b-col",[n("b-button",{attrs:{variant:"outline-success",block:""},on:{click:function(e){return t.verifyPin()}}},[t._v("OK")])],1),n("b-col",[n("b-button",{attrs:{variant:"outline-success",block:""},on:{click:function(e){return t.$refs["my-modal-pin"].hide()}}},[t._v("Cancel")])],1)],1)],1)],1)},i=[],r=n("1da1"),o=(n("96cf"),n("ac1f"),n("1276"),n("d3b7"),n("330b")),s=n("2f62"),c={name:"barcode-Cart",data:function(){return{dummy:[],showPaymentAlert:!1,showPaymentAlertTimer:null,fields:["index",{key:"barcode",label:"Item Name"},{key:"price",label:"Unit Price"},"quantity","amount"],pinCode:""}},computed:Object(s["b"])("barcode",["itemList","started","paymentStarted","paymentInfo","transactionCompleted"]),methods:{startScan:function(){o["a"].startScan()},proceedToPay:function(){o["a"].proceedToPay(),this.showPaymentAlertTimer&&clearTimeout(this.showPaymentAlertTimer),this.flashAlert()},flashAlert:function(){this.showPaymentAlertTimer&&clearTimeout(this.showPaymentAlertTimer),this.showPaymentAlert=!this.showPaymentAlert,this.showPaymentAlertTimer=setTimeout(this.flashAlert,1e3)},cancelPayment:function(){o["a"].cancelPayment()},confirmPayment:function(){console.log("confirmPayment - pinProtected: "+this.paymentInfo.pinProtected+", pinVerified: "+this.paymentInfo.pinVerified),o["a"].confirmPayment()},preConfirmPayment:function(){this.pinCode="",console.log("preConfirmPayment - pinProtected: "+this.paymentInfo.pinProtected+", pinVerified: "+this.paymentInfo.pinVerified),this.paymentInfo.pinProtected&&!this.paymentInfo.pinVerified?this.$refs["my-modal-pin"].show():this.confirmPayment()},verifyPin:function(){var t=this;""!=this.pinCode&&o["a"].verifyPin(this.pinCode).then((function(e){var n=e.data;console.log(n);var a=n.split(":")[0],i=n.split(":")[1];"OK"==a?(t.pinCode="",t.waitInMS(200).then((function(){return t.confirmPayment()})),t.$refs["my-modal-pin"].hide()):t.$bvModal.msgBoxOk(i,{centered:!0,size:"sm"})}))},waitInMS:function(t){return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=function(t){return new Promise((function(e){return setTimeout(e,t)}))},e.next=3,n(t);case 3:case"end":return e.stop()}}),e)})))()},startOver:function(){o["a"].startOver()},deleteItem:function(t){o["a"].deleteItem(t)},updateItem:function(t,e){t.quantity!=e&&(t.quantity=e,o["a"].updateItem(t))},isValidCard:function(){return null!=this.paymentInfo.cardNo&&""!=this.paymentInfo.cardNo},test1:function(t,e){alert(e+":"+t)},getCardImg:function(){if(this.isValidCard()){var t=this.paymentInfo.cardNo.substring(0,this.paymentInfo.cardNo.length-3);return t.toLowerCase()+".png"}}},created:function(){o["a"].connect()},mounted:function(){this.flashAlert()}},l=c,d=(n("a87a"),n("2877")),m=Object(d["a"])(l,a,i,!1,null,null,null);e["default"]=m.exports},"330b":function(t,e,n){"use strict";var a=n("d4ec"),i=n("bee2"),r=n("c427"),o=n("cc7d"),s=n.n(o),c=n("c6e1"),l=n.n(c),d=n("c319"),m=n("c0d6"),u=function(){function t(){Object(a["a"])(this,t)}return Object(i["a"])(t,[{key:"scan",value:function(t){return r["a"].get("../barcode/scan/"+t)}},{key:"getCurrentSessionID",value:function(){return r["a"].get("../barcode/sessionid")}},{key:"verifyPin",value:function(t){return r["a"].get("../barcode/verifyPin/"+t)}},{key:"connect",value:function(){var t=this;this.connected?console.log("already connected"):(this.socket=new s.a(d["a"].websocketURL),this.stompClient=l.a.over(this.socket),this.stompClient.connect({},(function(e){t.connected=!0,console.log(e),t.stompClient.subscribe("/topic/barcodeStatus",(function(t){m["a"].dispatch("barcode/update",JSON.parse(t.body))})),t.stompClient.send("/app/barcodeStatus",JSON.stringify({}),{})}),(function(e){console.log(e),t.connected=!1})))}},{key:"startScan",value:function(){this.stompClient.send("/app/barcodeStatus",JSON.stringify({started:!0}),{})}},{key:"proceedToPay",value:function(){this.stompClient.send("/app/barcodeStatus",JSON.stringify({paymentStarted:!0}),{})}},{key:"cancelPayment",value:function(){this.stompClient.send("/app/barcodeStatus",JSON.stringify({cancelPayment:!0}),{})}},{key:"confirmPayment",value:function(){this.stompClient.send("/app/barcodeStatus",JSON.stringify({confirmPayment:!0}),{})}},{key:"startOver",value:function(){this.stompClient.send("/app/barcodeStatus",JSON.stringify({startOver:!0}),{})}},{key:"deleteItem",value:function(t){this.stompClient.send("/app/barcodeStatus",JSON.stringify({deleteFlag:!0,barcodeItem:t}),{})}},{key:"updateItem",value:function(t){this.stompClient.send("/app/barcodeStatus",JSON.stringify({deleteFlag:!1,barcodeItem:t}),{})}},{key:"disconnect",value:function(){this.stompClient&&this.stompClient.disconnect(),this.connected=!1}},{key:"getAllGiftCards",value:function(){return r["a"].get("../barcode/card/all")}},{key:"changePIN",value:function(t,e,n){return r["a"].get("../barcode/card/changePin/"+t+":"+e+":"+n)}},{key:"transferBalance",value:function(t,e,n,a){return r["a"].get("../barcode/card/transfer/"+t+":"+a+":"+e+":"+n)}}]),t}();e["a"]=new u},"383b":function(t,e,n){},a87a:function(t,e,n){"use strict";n("383b")}}]);
//# sourceMappingURL=chunk-174e8b00.a7c9c19a.js.map